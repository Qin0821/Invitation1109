<!DOCTYPE html>
<html lang="en">
	<head>
		<title>思事源 善若水</title>
		<meta charset="UTF-8" />
		<meta
			name="viewport"
			content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no"
		/>
		<meta name="mobile-web-app-capable" content="yes" />
		<meta name="apple-mobile-web-app-capable" content="yes" />
		<meta name="apple-mobile-web-app-status-bar-style" content="black" />
		<!-- <link href="https://cdn.bootcss.com/fullPage.js/3.0.7/fullpage.min.css" rel="stylesheet"> -->
		<link
			href="https://cdn.bootcss.com/Swiper/4.5.1/css/swiper.min.css"
			rel="stylesheet"
		/>
		<link
			href="https://cdn.bootcss.com/jquery-confirm/3.3.4/jquery-confirm.min.css"
			rel="stylesheet"
		/>
		<link
			href="https://cdn.bootcss.com/animate.css/3.7.2/animate.css"
			rel="stylesheet"
		/>
		<style>
			@font-face {
				font-family: 'iconfont'; /* project id 1449699 */
				src: url('http://at.alicdn.com/t/font_1449699_ndr14l18x3.eot');
				src: url('http://at.alicdn.com/t/font_1449699_ndr14l18x3.eot?#iefix')
						format('embedded-opentype'),
					url('http://at.alicdn.com/t/font_1449699_ndr14l18x3.woff2')
						format('woff2'),
					url('http://at.alicdn.com/t/font_1449699_ndr14l18x3.woff')
						format('woff'),
					url('http://at.alicdn.com/t/font_1449699_ndr14l18x3.ttf')
						format('truetype'),
					url('http://at.alicdn.com/t/font_1449699_ndr14l18x3.svg#iconfont')
						format('svg');
			}
			.iconfont {
				font-family: 'iconfont' !important;
				font-size: 16px;
				font-style: normal;
				-webkit-font-smoothing: antialiased;
				-webkit-text-stroke-width: 0.2px;
				-moz-osx-font-smoothing: grayscale;
			}
			* {
				margin: 0;
				padding: 0;
				box-sizing: border-box;
				-webkit-tap-highlight-color: rgba(0, 0, 0, 0);
				-webkit-touch-callout: none;
			}

			html,
			body {
				width: 100%;
				height: 100%;
				position: relative;
				background: #eee;
				overflow: hidden;
			}

			.page-two {
				background-image: url('http://static.yudada.com/web/img/1.jpeg');
				background-position: center;
				background-size: cover;
			}

			.content {
				height: 100%;
				overflow-y: auto;
			}

			.page-view {
				background-position: center;
				background-size: cover;
				background-repeat: no-repeat;
			}

			

			/* .page-2 {
				background-image: url('http://static.yudada.com/web/img/1.jpg');
				visibility: hidden;
			}

			.page-3 {
				background-image: url('http://static.yudada.com/web/img/3.jpg');
				visibility: hidden;
			}

			.page-4 {
				background-image: url('http://static.yudada.com/web/img/4.jpg');
				visibility: hidden;
			} */

			.page-two {
				padding: 10% 15%;
				color: #fff;
			}

			.form-item,
			.form-select {
				padding: 5px 0;
			}

			.form-item input {
				padding: 5px;
				width: 100%;
				margin-top: 10px;
				font-size: 18px;
				line-height: 30px;
				outline: none;
				width: 100%;
			}

			.form-select select {
				line-height: 35px;
				height: 35px;
				width: 100%;
				background: #bbb;
				font-size: 18px;
				color: #fff;
				outline: none;
				border: none;
				margin-top: 10px;
			}

			.footer {
				padding-top: 10px;
				font-size: 14px;
			}

			.footer .text {
				margin-bottom: 10px;
			}

			.submit-btn {
				width: 100%;
				left: 25%;
				transition: all 0.8s ease;
				line-height: 40px;
				text-align: center;
				font-size: 20px;
				background: #012967;
				color: #fff;
				border-radius: 8px;
				margin-top: 20px;
			}

			.submit-btn.active {
				background: #183664;
			}

			.page-view img {
				width: 100%;
			}

			.page-1 {
				background-image: url('http://static.yudada.com/web/img/test/first.jpg');
			}

			.page-2 {
				background-image: url('http://static.yudada.com/web/img/1.jpeg');
			}

			.page-3 {
				background-image: url('http://static.yudada.com/web/img/1.jpeg');
			}

			.page-4 {
				background-image: url('http://static.yudada.com/web/img/1.jpeg');
			}

			.logo {
				width: 30vw;
				position: absolute;
				top: 20px;
				left: 15px;
				background-size: 100%;
			}

			.page-1 .title11 {
				width: 40vw;
				height: auto;
				position: absolute;
				top: 13vh;
				left: 30vw;
			}

			.page-1 .title12 {
				width: 60vw;
				height: auto;
				position: absolute;
				top: 56vh;
				left: 20vw;
			}

			.page-1 .title13 {
				width: 60vw;
				height: auto;
				position: absolute;
				top: 42vh;
				left: 20vw;
			}

			.page-1 .addtime {
				width: 50vw;
				height: auto;
				position: absolute;
				bottom: 9vh;
				left: 25vw;
			}

			.page-2 .czyq {
				width: 36vw;
				height: auto;
				position: absolute;
				top: 4vh;
				right: 12vw;
			}

			.page-2 .page2_c {
				width: 73vw;
				height: auto;
				position: absolute;
				bottom: 7vh;
				left: 8vw;
			}

			.page-3 .hdlc {
				width: 36vw;
				height: auto;
				position: absolute;
				top: 15vh;
				left: 18vw;
			}

			.page-3 .page3_c {
				width: 80vw;
				height: auto;
				position: absolute;
				top: 40vh;
				left: 8vw;
			}

			.page-4 .sjdz {
				width: 36vw;
				height: auto;
				position: absolute;
				top: 12vh;
				right: 18vw;
			}

			.page-4 .page4_c {
				width: 80vw;
				height: auto;
				position: absolute;
				top: 32vh;
				left: 8vw;
			}

			.jconfirm .jconfirm-holder {
				width: 65%;
				margin: auto;
			}

			[contenteditable='true'],
			input,
			textarea {
				-webkit-user-select: text;
			}

			.item-label {
				line-height: 30px;
			}
			.swiper-container {
				--swiper-navigation-color: #fff; /* 单独设置按钮颜色 */
				--swiper-navigation-size: 30px; /* 设置按钮大小 */
			}
			.icon-up {
				font-size: 35px;
				position: absolute;
				left: 50%;
				margin-left: -17px;
				color: #d9c9a5;
				bottom: 10px;
				animation: mymove 1.5s infinite;
				-webkit-animation: mymove 1.5s infinite;
				transition: all 0.2s ease;
			}
			@keyframes mymove {
				0% {
					bottom: 10px;
					opacity: 0.5;
				}
				50% {
					bottom: 18px;
					opacity: 0.75;
				}
				100% {
					bottom: 25px;
					opacity: 1;
				}
			}
			@-webkit-keyframes mymove {
				0% {
					bottom: 10px;
					opacity: 0.5;
				}
				50% {
					bottom: 18px;
					opacity: 0.75;
				}
				100% {
					bottom: 25px;
					opacity: 1;
				}
			}
		</style>
	</head>

	<body>
		<div class="swiper-container" id="fullpage" style="height: 100%">
			<div class="swiper-wrapper" style="height: 100%">
				<div class="swiper-slide page-view page-1">
					<div class="logo fadeIn animated delay-1s">
						<img src="http://static.yudada.com/web/img/test/logo.png" />
					</div>
					<div class="title11 zoomIn  animated delay-1s">
						<img src="http://static.yudada.com/web/img/test/title11.png" />
					</div>
					<div class="title12 slideInUp animated">
						<img src="http://static.yudada.com/web/img/test/title12.png" />
					</div>
					<div class="title13 slideInDown animated">
						<img src="http://static.yudada.com/web/img/test/title13.png" />
					</div>
					<div class="addtime slideInUp  animated">
						<img src="http://static.yudada.com/web/img/test/addtime.png" />
					</div>
					<i class="iconfont icon-up">&#xe63b;</i>
				</div>

				<div class="swiper-slide page-view page-2">
					<div class="logo fadeIn animated delay-1s">
						<img src="http://static.yudada.com/web/img/test/logo.png" />
					</div>
					<div class="czyq slideInDown  animated ">
						<img src="http://static.yudada.com/web/img/test/czyq.png" />
					</div>
					<div class="page2_c  slideInUp   animated ">
						<img src="http://static.yudada.com/web/img/test/page2_c.png" />
					</div>
					<i class="iconfont icon-up">&#xe63b;</i>
				</div>

				<!-- <div class="swiper-slide page-view page-3">
					<div class="logo fadeIn animated delay-1s">
						<img src="http://static.yudada.com/web/img/test/logo.png" />
					</div>
					<div class="hdlc slideInRight  animated ">
						<img src="http://static.yudada.com/web/img/test/hdlc.png" />
					</div>
					<div class="page3_c  slideInLeft   animated ">
						<img src="http://static.yudada.com/web/img/test/page3_c.png" />
					</div>
					<i class="iconfont icon-up">&#xe63b;</i>
				</div> -->

				<div class="swiper-slide page-view page-4">
					<div class="logo fadeIn animated delay-1s">
						<img src="http://static.yudada.com/web/img/test/logo.png" />
					</div>
					<div class="sjdz slideInRight  animated ">
						<img src="http://static.yudada.com/web/img/test/sjdz.png" />
					</div>
					<div class="page4_c  slideInLeft   animated ">
						<img src="http://static.yudada.com/web/img/test/page4_c.png" style="width: 80%;" />
					</div>
					<i class="iconfont icon-up">&#xe63b;</i>
				</div>

				<div class="swiper-slide page page-two">
					<div class="content">
						<div class="title">请填写</div>
						<div class="form-item">
							<div class="item-label">公司(COMPANY)</div>
							<input type="text" class="input-company" />
						</div>

						<div class="form-item">
							<div class="item-label">姓名(YOU NAME)</div>
							<input type="text" class="input-name" />
						</div>

						<div class="form-item">
							<div class="item-label">手机号(YOU PHONE NUMBER)</div>
							<input type="tel" class="input-phone" />
						</div>

						<div class="form-select">
							<div class="item-label">请选择标注(PLEASE TICK)</div>
							<select name="select-label" id="select-label">
								<option value="1">我将亲自出席（I will be present）</option>
								<option value="2"
									>很遗憾，我无法出席（I regret that i won't present）</option
								>
								<option value="3"
									>很遗憾我无法亲自出席，将派代表出席（I personaly won't be
									present but a representative be sent）</option
								>
							</select>
						</div>

						<div class="form-item representative-name">
							<div class="item-label">代表姓名(The representative's name)</div>
							<input type="text" class="input-representative-name" />
						</div>

						<div class="submit-btn">提交</div>
					</div>
				</div>
				<audio
					src="http://static.yudada.com/web/img/test.mp3"
					autoplay
					loop
					preload
					style="display: none;"
					id="music"
				></audio>
			</div>
		</div>
		<script src="https://cdn.bootcss.com/jquery/3.4.1/jquery.min.js"></script>
		<!-- <script src="https://cdn.bootcss.com/fullPage.js/3.0.7/vendors/easings.min.js"></script> -->
		<!-- <script src="https://cdn.bootcss.com/fullPage.js/3.0.7/vendors/scrolloverflow.min.js"></script> -->
		<!-- <script src="https://cdn.bootcss.com/fullPage.js/3.0.7/fullpage.extensions.min.js"></script> -->
		<!-- <script src="https://cdn.bootcss.com/fullPage.js/3.0.7/fullpage.min.js"></script> -->
		<script src="https://cdn.bootcss.com/Swiper/4.5.1/js/swiper.min.js"></script>
		<script src="https://cdn.bootcss.com/jquery-confirm/3.3.4/jquery-confirm.min.js"></script>
		<script src="http://res.wx.qq.com/open/js/jweixin-1.2.0.js"></script>
		<script>
			$(function() {
				var img = $('<img scr="http://static.yudada.com/web/img/1.jpeg" />');
				var img = document.createElement('img');
				img.src = 'http://static.yudada.com/web/img/1.jpeg';
				img.onload = function() {
					init();
				};
				var $btn = $('.submit-btn');
				var $company = $('.input-company');
				var $name = $('.input-name');
				var $select = $('#select-label');
				var $music = $('#music');
				var $rName = $('.representative-name');
				var $rNameInput = $('.input-representative-name');
				var $phone = $('.input-phone');
				$rName.hide();
				$btn.hide();
				// var myFullpage = new fullpage('#fullpage', {
				//      autoScrolling: false,
				//      scrollHorizontally: false,
				//      fitToSectionDelay: 200,
				//      scrollingSpeed: 200,
				//      touchSensitivity: 3,
				//      navigation: true,
				//      navigationColor: '#fff'
				// });
				var mySwiper;
				function init() {
					var index = 0;
					mySwiper = new Swiper('.swiper-container', {
						autoplay: false,
						direction: 'vertical',
						effect: 'cube',
						cubeEffect: {
							slideShadows: true,
							shadow: true,
							shadowOffset: 100,
							shadowScale: 0.6
						},
						on: {
							init: function() {
								setTimeout(function() {
									var audio = $('#music')[0];
									audio.load();
									let playPromise = audio.play();
									if (playPromise !== undefined) {
										playPromise
											.then(() => {
												audio.play();
											})
											.catch(() => {});
									}
									$btn.show();
								}, 3000);
							},
							touchStart: function() {
								var audio = $('#music')[0];
								if (audio.paused) {
									let playPromise = audio.play();
									if (playPromise !== undefined) {
										playPromise
											.then(() => {
												audio.play();
											})
											.catch(() => {});
									}
								}
							},
							slideChangeTransitionStart: function() {
								if (index == this.activeIndex) {
									return;
								}

								$('.page-2,.page-3,.page-4').css('visible', 'visibility');
								$('.page-1')
									.find('.logo')
									.removeClass('fadeIn animated delay-1s')
									.addClass('fadeOut');
								$('.page-1')
									.find('.title11')
									.removeClass('zoomIn  animated delay-1s')
									.addClass('zoomOut');
								$('.page-1')
									.find('.title12')
									.removeClass('slideInUp animated')
									.addClass('zoomOut');
								$('.page-1')
									.find('.title13')
									.removeClass('slideInDown animated')
									.addClass('slideOutDown');
								$('.page-1')
									.find('.addtime')
									.removeClass('slideInUp animated')
									.addClass('slideOutUp');

								$('.page-2')
									.find('.logo')
									.removeClass('fadeIn animated delay-1s')
									.addClass('fadeOut');
								$('.page-2')
									.find('.czyq')
									.removeClass('slideInDown  animated')
									.addClass('slideOutDown');
								$('.page-2')
									.find('.page2_c')
									.removeClass('slideInUp animated')
									.addClass('slideOutUp');

								$('.page-3')
									.find('.logo')
									.removeClass('fadeIn animated delay-1s')
									.addClass('fadeOut');
								$('.page-3')
									.find('.hdlc')
									.removeClass('slideInRight animated')
									.addClass('slideOutRight');
								$('.page-3')
									.find('.page3_c')
									.removeClass('slideInLeft  animated')
									.addClass('slideOutLeft');

								$('.page-4')
									.find('.logo')
									.removeClass('fadeIn animated delay-1s')
									.addClass('fadeOut');

								$('.page-4')
									.find('.sjdz')
									.removeClass('slideInDown  animated')
									.addClass('slideOutDown');
								$('.page-4')
									.find('.page4_c')
									.removeClass('slideInUp   animated')
									.addClass('slideOutUp');
							},
							slideChangeTransitionEnd: function() {
								if (index == this.activeIndex) {
									return;
								}
								index = this.activeIndex;
								$('.page-4>div').css('visible', 'visibility');

								if (this.activeIndex == 0) {
									$('.page-1>div').css('visible', 'hidden');
									$('.page-1>div').css('visible', 'visibility');
									setTimeout(function() {
										$('.page-1')
											.find('.logo')
											.removeClass('fadeOut')
											.addClass('fadeIn animated delay-1s');
										$('.page-1')
											.find('.title11')
											.removeClass('zoomOut')
											.addClass(' zoomIn  animated delay-1s');
										$('.page-1')
											.find('.title12')
											.removeClass('slideOutUp')
											.addClass('slideInUp animated');
										$('.page-1')
											.find('.title13')
											.removeClass('slideOutDown')
											.addClass('slideInDown animated');
										$('.page-1')
											.find('.addtime')
											.removeClass('slideOutUp')
											.addClass('slideInUp animated');
										$('.page-1>div').css('visible', 'visibility');
									}, 0);
								} else if (this.activeIndex == 1) {
									$('.page-2>div').css('visible', 'hidden');

									setTimeout(function() {
										$('.page-2')
											.find('.logo')
											.removeClass('fadeOut')
											.addClass('fadeIn animated delay-1s');
										$('.page-2')
											.find('.czyq')
											.removeClass('slideOutDown')
											.addClass('slideInDown  animated');
										$('.page-2')
											.find('.page2_c')
											.removeClass('slideOutUp')
											.addClass('slideInUp   animated');
										$('.page-2>div').css('visible', 'visibility');
									}, 0);
								// } else if (this.activeIndex == 2) {
								// 	$('.page-3>div').css('visible', 'hidden');

								// 	setTimeout(function() {
								// 		$('.page-3')
								// 			.find('.logo')
								// 			.removeClass('fadeOut')
								// 			.addClass('fadeIn animated delay-1s');
								// 		$('.page-3')
								// 			.find('.hdlc')
								// 			.removeClass('slideOutRight')
								// 			.addClass('slideInRight animated');
								// 		$('.page-3')
								// 			.find('.page3_c')
								// 			.removeClass('slideOutLeft')
								// 			.addClass('slideInLeft  animated');
								// 		$('.page-3>div').css('visible', 'visibility');
								// 	}, 0);
								} else if (this.activeIndex == 2) {
									$('.page-4>div').css('visible', 'hidden');

									setTimeout(function() {
										$('.page-4')
											.find('.logo')
											.removeClass('fadeOut')
											.addClass('fadeIn animated delay-1s');
										$('.page-4')
											.find('.sjdz')
											.removeClass('slideOutDown')
											.addClass('slideInDown  animated');
										$('.page-4')
											.find('.page4_c')
											.removeClass('slideOutUp')
											.addClass('slideInUp   animated');
										$('.page-4>div').css('visible', 'visibility');
									}, 0);
								}
							}
						}
					});
				}

				//methods
				// myFullpage.setAllowScrolling(false);
				$select.change(function(v) {
					var val = $select[0].value;
					$rName[val == 3 ? 'show' : 'hide'](300);
					mySwiper.slideTo(5);
				});

				function checkData() {
					var err = '';
					if ($select[0].value == 3 && !$rNameInput.val()) {
						err = '请填写代表姓名~';
					}

					if (!$phone.val() || $phone.val().length !== 11) {
						err = '请填写正确的手机号~';
					}

					if (!$name.val()) {
						err = '请填写姓名~';
					}

					if (!$company.val()) {
						err = '请填写公司名称~';
					}
					return err;
				}

				$btn.click(function() {
					var err = checkData();
					$btn.addClass('active');
					setTimeout(() => {
						$btn.removeClass('active');
					}, 500);
					if (err || $btn.hasClass('send')) {
						$.dialog({
							title: '提示!',
							content: err || '提交中...请耐心等候！',
							columnClass: 'medium',
							boxWidth: '70%'
						});
						return;
					}
					$btn.addClass('send');
					$btn.text('提交中...');

					var data = {
						name: $name.val(),
						company_name: $company.val(),
						company_name: '',
						tick_type: $select.val(),
						phone: $phone.val()
					};
					$select.val() == 3 && (data.representative_name = $rNameInput.val());
					$.ajax({
						type: 'POST',
						url: 'http://simpure.org/api/user',
						data: data,
						dataType: 'json',
						success: function(res) {
							if (res.code != 1 && res.code != 2) {
								$.dialog({
									title: '提示!',
									content: res.message || '服务器忙，请稍后再试~',
									columnClass: 'medium',
									boxWidth: '70%'
								});
								return;
							}
							$.confirm({
								title: '签到二维码，长按可保存哦~',
								content: function() {
									var vm = this;
									setTimeout(() => {
										vm.setContentAppend(
											'<img style="min-height: 50px;" src="http://qr.liantu.com/api.php?text=http://simpure.org/api/sign/' +
												res.data.id +
												'" />'
										);
										vm.setTitle('签到二维码，长按可保存哦~');
									}, 200);
								},
								columnClass: 'medium',
								boxWidth: '70%'
							});
						},
						error: function(err) {
							console.log(err);
						},
						complete: function() {
							$btn.removeClass('send');
							$btn.text('提交');
						}
					});
				});

				
				$.ajax({
						type: 'GET',
						url: 'http://simpure.org/api/wxconfig',
						// data: data,
						dataType: 'json',
						success: function(res) {
							console.log(res)
							wx.config({
								appId: res.data.appid,
								timestamp: res.data.timestamp,
								nonceStr: res.data.nonceStr,
								signature: res.data.signature,
								jsApiList: ['onMenuShareTimeline', 'onMenuShareAppMessage']
							});
							wx.ready(() => {
								console.log('wx ready')
								 // 分享给朋友
								 wx.onMenuShareAppMessage({
									title: '思事源 善若水',
									desc: '上海新国际博览中心客户答谢会~邀请函',
									link: location.href,
									imgUrl: 'http://static.yudada.com/web/img/test/logo.png',
									success: function () {
										$.confirm({
											title: '分享成功~',
											columnClass: 'medium',
											boxWidth: '70%'
										});
									}
								 });
								// 分享到朋友圈
								wx.onMenuShareTimeline({
									title: '思事源 善若水',
									desc: '上海新国际博览中心客户答谢会~邀请函',
									link: location.href,
									imgUrl: 'http://static.yudada.com/web/img/test/logo.png',
									success: function () {
										$.confirm({
											title: '分享成功~',
											columnClass: 'medium',
											boxWidth: '70%'
										});
									}
								 });
							});
							wx.error(function(res){
								console.log('err', res)
							});
						},
						error: function(err) {
							console.log(err);
						}
				})
			});
		</script>
	</body>
</html>

